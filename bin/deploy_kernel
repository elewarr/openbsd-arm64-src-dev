#!/usr/bin/env ksh
set -e
set -o xtrace

cleanup() {
	doas umount /mnt
	exit $?
}

tmpdir="$(mktemp)"
trap "cleanup" EXIT
. "$(dirname $(readlink -f $0))/.env"

if [ -z "${CROSS_OPENBSD_SRC_HOME}" ]; then
	echo CROSS_OPENBSD_SRC_HOME is missing
	exit 1
fi

#cleanup || true

doas mount /dev/sd1a /mnt
doas cp "${CROSS_OPENBSD_SRC_HOME}/dest.armv7/usr/obj/sys/arch/armv7/compile/DEBUG/bsd.gdb" "/mnt/bsd"
ls -la /mnt
sync
